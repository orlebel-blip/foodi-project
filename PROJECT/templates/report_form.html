<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8">
  <title>דיווח עומס למסעדה</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
  <div class="container">
    <h2 class="page-title">📣 דיווח עומס למסעדה</h2>

    <form method="post" action="/report" class="form-card" autocomplete="off">

      <!-- טלפון -->
      <div class="form-group">
        <label>טלפון:</label>
        <input
          type="text"
          id="phone"
          name="phone"
          inputmode="numeric"
          maxlength="10"
          placeholder=""
          required
        >
      </div>

      <!-- מסעדה -->
      <div class="form-group">
        <label>בחרי או כתבי שם מסעדה:</label>
        <input
          type="text"
          name="restaurant_name"
          list="restaurants_list"
          placeholder="התחילי להקליד או לבחור מהרשימה"
          required
        >

        <datalist id="restaurants_list">
          {% for r in restaurants %}
            <option value="{{ r.name }}">
          {% endfor %}
        </datalist>
      </div>

      <!-- זמן המתנה -->
      <div class="form-group">
        <label>זמן המתנה (בדקות):</label>
        <input
          type="number"
          name="wait_minutes"
          min="0"
          placeholder=""
          required
        >
      </div>

      <!-- מקומות פנויים -->
      <div class="form-group">
        <label>מקומות פנויים (אופציונלי):</label>
        <input
          type="number"
          name="available_seats"
          min="0"
          placeholder=""
        >
      </div>

      <button class="btn" type="submit">שליחה</button>
    </form>
  </div>

  <div style="margin-top: 30px; text-align: center;">
    <a href="{{ url_for('home') }}" class="btn back-btn">
        ⬅ חזרה לדף הבית
    </a>
</div>

  <!-- ולידציה לטלפון -->
  <script>
    const phone = document.getElementById("phone");

    // חסימה בזמן הקלדה
    phone.addEventListener("input", () => {
      phone.value = phone.value.replace(/[^0-9]/g, "").slice(0, 10);
    });

    // חסימה בהדבקה
    phone.addEventListener("paste", (e) => {
      e.preventDefault();
      const text = (e.clipboardData || window.clipboardData).getData("text");
      phone.value = text.replace(/[^0-9]/g, "").slice(0, 10);
    });

    // בדיקה בשליחה
    document.querySelector(".form-card").addEventListener("submit", (e) => {
      if (!/^[0-9]{10}$/.test(phone.value)) {
        e.preventDefault();
        phone.focus();
        alert("מספר טלפון לא תקין. יש להזין 10 ספרות בלבד.");
      }
    });
  </script>
</body>
</html>
